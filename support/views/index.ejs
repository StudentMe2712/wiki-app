<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–¢–°-–ö–æ–º - Wiki</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <!-- –®–∞–ø–∫–∞ —Å–∞–π—Ç–∞ -->
    <header class="header">
        <div class="header-left">
            <div class="logo">
                <span class="logo-icon">–ò–¢–°-–ö–æ–º</span>
                <span class="logo-text">–ò–¢–°-–ö–æ–º</span>
            </div>
        </div>
        <div class="header-right">
            <span class="user-info">–í–æ—à–ª–∏ –∫–∞–∫ <%= user.username %></span>
            <a href="/logout" class="header-link">–í—ã–π—Ç–∏</a>
        </div>
    </header>

    <!-- –ü–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
    <nav class="navbar">
        <button class="nav-btn" id="addOrgBtn">+ –ù–æ–≤–∞—è wiki-—Å—Ç—Ä–∞–Ω–∏—Ü–∞</button>
        <a href="/" class="nav-link <%= page === 'home' ? 'active' : '' %>">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="#" class="nav-link">–ó–∞–¥–∞—á–∏</a>
        <a href="#" class="nav-link <%= page === 'organization' ? 'active' : '' %>">Wiki</a>
    </nav>

    <div class="container">
        <!-- –õ–µ–≤–æ–µ –º–µ–Ω—é -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h3>Wiki</h3>
            </div>
            <ul class="org-list" id="orgList">
                <% if (organizations && organizations.length > 0) { %>
                    <% organizations.forEach(org => { %>
                        <li class="org-item <%= currentOrg && currentOrg.id === org.id ? 'active' : '' %>">
                            <a href="/organization/<%= org.id %>" class="org-link">
                                <%= org.name %>
                            </a>
                        </li>
                    <% }); %>
                <% } else { %>
                    <li class="org-item empty">–ù–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π</li>
                <% } %>
            </ul>
        </aside>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="content">
            <% if (page === 'home') { %>
                <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
                <div class="welcome">
                    <h1>–ò–¢–°-–ö–æ–º - –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π</h1>
                    <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–Ω–∞–Ω–∏—è–º–∏ –ò–¢–°-–ö–æ–º.</p>
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –≤ –º–µ–Ω—é —Å–ª–µ–≤–∞ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é, –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É "+ –ù–æ–≤–∞—è wiki-—Å—Ç—Ä–∞–Ω–∏—Ü–∞".</p>
                </div>
            <% } else if (currentOrg) { %>
                <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ -->
                <div class="org-page">
                    <div class="page-header">
                        <h1 id="orgTitle"><%= currentOrg.name %></h1>
                        <div class="page-actions">
                            <button class="btn btn-primary" id="editBtn">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                            <button class="btn btn-secondary" id="deleteBtn">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                            <div class="export-dropdown">
                                <button class="btn btn-secondary" id="exportBtn">‚¨áÔ∏è –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                                <div class="dropdown-menu" id="exportMenu">
                                    <a href="/api/export/pdf/<%= currentOrg.id %>" class="dropdown-item">üìÑ PDF</a>
                                    <a href="/api/export/txt/<%= currentOrg.id %>" class="dropdown-item">üìù TXT</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="page-content" id="pageContent">
                        <% if (currentOrg.content && currentOrg.content.trim() !== '') { %>
                            <pre><%= currentOrg.content %></pre>
                        <% } else { %>
                            <p class="empty-content">–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—É—Å—Ç–æ. –ù–∞–∂–º–∏—Ç–µ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.</p>
                        <% } %>
                    </div>
                    
                    <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
                    <div class="edit-form" id="editForm" style="display: none;">
                        <div class="form-group">
                            <label for="orgNameInput">–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:</label>
                            <input type="text" id="orgNameInput" class="form-input" value="<%= currentOrg.name %>">
                        </div>
                        <div class="form-group">
                            <label for="orgContentInput">–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:</label>
                            <textarea id="orgContentInput" class="form-textarea" rows="20"><%= currentOrg.content %></textarea>
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-success" id="saveBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            <button class="btn btn-secondary" id="cancelBtn">‚ùå –û—Ç–º–µ–Ω–∞</button>
                        </div>
                    </div>
                    
                    <input type="hidden" id="currentOrgId" value="<%= currentOrg.id %>">
                </div>
            <% } %>
        </main>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ -->
    <div class="modal" id="addOrgModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ù–æ–≤–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è</h2>
                <button class="modal-close" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="newOrgName">–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:</label>
                    <input type="text" id="newOrgName" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
                </div>
                <div class="form-group">
                    <label for="newOrgContent">–°–æ–¥–µ—Ä–∂–∏–º–æ–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                    <textarea id="newOrgContent" class="form-textarea" rows="10" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success" id="createOrgBtn">–°–æ–∑–¥–∞—Ç—å</button>
                <button class="btn btn-secondary" id="cancelModalBtn">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script src="/js/main.js"></script>
</body>
</html>


